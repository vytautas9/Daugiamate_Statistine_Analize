---
title: "Daugiamatė Statistinė Analizė Lab 3, 6 variantas"
author: "Vytautas Kraujalis"
date: '2021-12-04'
output: 
  word_document:
    toc: true 
    toc_depth: 3
    number_sections: true
    highlight: tango
---



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

# Uzd. 1
## 1
```{r}
library(openxlsx)

atstumai <- read.xlsx("atstumai.xlsx", rowNames = TRUE)

knitr::kable(atstumai)
```

## 3
```{r}

dist_mat <- dist(atstumai, method = "euclidean")
hclust_average <- hclust(dist_mat, method = "average")
hclust_complete <- hclust(dist_mat, method = "complete")
hclust_centroid <- hclust(dist_mat, method = "centroid")
hclust_single <- hclust(dist_mat, method = "single")


plot(hclust_average, main = "Vidutinio atstumo metodas")
plot(hclust_complete, main = "Tolimiausio kaimyno metodas")
plot(hclust_centroid, main = "Atstumo tarp centru metodas")
plot(hclust_single, main = "Artimiausio kaimyno metodas")
```



# Uzd. 2
## 1
```{r}
# Metric MDS
fit <- cmdscale(dist_mat)
fit
# plot solution
plot(fit, xlab="Coordinate 1", ylab="Coordinate 2", main="Metric MDS, cmdscale()", type="n")
text(fit, labels = colnames(atstumai), cex=.7)
```

```{r}
library(MASS)
# Sammon
fit <- sammon(dist_mat)
fit 
# plot solution
plot(fit$points, xlab="Coordinate 1", ylab="Coordinate 2", main="Nonmetric MDS, sammon()", type="n")
text(fit$points, labels = colnames(atstumai), cex=.7) 
```


# Uzd. 3
## 1
```{r}
p1 <- p2 <- p3 <- 1/3

m1 <- c(0, 0, 0)
m2 <- c(-9, -5, 1)
m3 <- c(3.99618, 0, 6.930407)

R1 <- matrix(
  c(
    3.8571, 0, -0.2162,
    0, 8.344, 0,
    -0.2162, 0, 4.8989
  ),
  nrow = 3, ncol = 3
)
R2 <- matrix(
  c(
    3.83, 2.281, 0,
    2.281, 3.55, 0,
    0, 0, 7.573
  ),
  nrow = 3, ncol = 3
)
R3 <- matrix(
  c(
    9.935, 0, 0,
    0, 7.6078, -0.3615,
    0, -0.3615, 7.7082
  ),
  nrow = 3, ncol = 3
)
```

```{r}
n1 <- sum(runif(100) < p1)
n2 <- sum(runif(100) < p1)
n3 <- 100 - n1 - n2

gauso_ad_100 <- rbind(mvrnorm(n1, m1, R1), mvrnorm(n2, m2, R2), mvrnorm(n3, m3, R3))

n1 <- sum(runif(500) < p1)
n2 <- sum(runif(500) < p1)
n3 <- 500 - n1 - n2

gauso_ad_500 <- rbind(mvrnorm(n1, m1, R1), mvrnorm(n2, m2, R2), mvrnorm(n3, m3, R3))

n1 <- sum(runif(3000) < p1)
n2 <- sum(runif(3000) < p1)
n3 <- 3000 - n1 - n2

gauso_ad_3000 <- rbind(mvrnorm(n1, m1, R1), mvrnorm(n2, m2, R2), mvrnorm(n3, m3, R3))
```



## 2
```{r}

```




























